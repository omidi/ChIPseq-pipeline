%!PS-Adobe-3.0 EPSF-3.0
%%Title:        Sequence Logo: 
%%Creator:      WebLogo 3.4 (2014-06-02)
%%CreationDate: 2014-08-07 15:27:11.283821
%%BoundingBox:  0  0  281  80 
%%Pages: 0
%%DocumentFonts: 
%%EndComments


% ---- VARIABLES ----

/True   true def
/False  false def

/debug              True        def

/logo_height        80  def
/logo_width         281  def
/logo_title         () def
/show_title         False def

/logo_margin        2 def
/xaxis_label_height 6.0 def
/title_height       0 def
/stroke_width       0.5 def
/tic_length         5 def

/lines_per_logo     1 def
/line_width         277.6 def
/line_height        70.0 def
/line_margin_left   30.0 def
/line_margin_right  10 def
/line_margin_bottom 12.0 def
/line_margin_top    4 def

/stack_width         10.8 def
/stack_height        54.0 def
/stacks_per_line     22 def
/stack_margin        0.5 def

/show_yaxis             True def      
/show_yaxis_label       True def
/yaxis_label            (nats) def
/yaxis_scale          1.38629436112 def              % height in units 
/yaxis_tic_interval     1.0 def           % in units
/yaxis_minor_tic_interval 0.2 def   % in units

/show_xaxis_label       False def             % True or False
/show_xaxis             True def                   % True or False
/xaxis_label            () def
/xaxis_tic_interval     1 def
/rotate_numbers         False def               % True or False
/number_interval        5 def
/show_ends              False def          
/end_type               (-) def          % d: DNA, p: PROTEIN, -: none

/show_fineprint         True def
/fineprint              (Custom units) def
/logo_label             () def

/show_boxes             False def    % True or False
/shrink                 false def    % True or False
/shrink_fraction        0.5 def               

/show_errorbars         True def      % True or False
/errorbar_fraction      0.9 def
/errorbar_width_fraction  0.25 def
/errorbar_gray          0.75 def

/fontsize               10 def
/small_fontsize         6 def
/title_fontsize         12 def
/number_fontsize        8 def


/UseCIEColor true def       % Fix for issue 4
/default_color [ 0.0 0.0 0.0 ] def 
/color_dict << 
  (T) [ 1.0 0.549019607843 0.0 ]
  (A) [ 1.0 0.549019607843 0.0 ]
  (U) [ 1.0 0.549019607843 0.0 ]
  (G) [ 0.0 0.0 1.0 ]
  (C) [ 0.0 0.0 1.0 ]
>> def



% ---- DERIVED PARAMETERS ----

/char_width stack_width 2 stack_margin mul sub def
/char_width2 char_width 2 div def
/char_width4 char_width 4 div def

% movements to place 5'/N and 3'/C symbols
/leftEndDeltaX  fontsize neg         def
/leftEndDeltaY  fontsize 1.25 mul neg def
/rightEndDeltaX fontsize 0.25 mul     def
/rightEndDeltaY leftEndDeltaY        def


% ---- PROCEDURES ----


/SetTitleFont {/ArialMT findfont title_fontsize scalefont setfont} bind def
/SetLogoFont  {/Arial-BoldMT findfont char_width  scalefont setfont} bind def
/SetStringFont{/ArialMT findfont fontsize scalefont setfont} bind def
/SetPrimeFont {/Symbol findfont fontsize scalefont setfont} bind def
/SetSmallFont {/ArialMT findfont small_fontsize scalefont setfont} bind def
/SetNumberFont {/ArialMT findfont number_fontsize scalefont setfont} bind def

/DrawBox { % width height 
    /hh exch def
    /ww exch def
    gsave
        0.2 setlinewidth
        %0.5 setgray
        
        %0 0 moveto 
        hh 0 rlineto
        0 ww rlineto
        hh neg 0 rlineto
        0 ww neg rlineto
        stroke
    grestore
} bind def


/StartLogo { 
  %save 
  gsave 

  
  debug { 
    logo_margin logo_margin moveto
    logo_height logo_margin 2 mul sub
    logo_width logo_margin 2 mul sub
    DrawBox } if
    
  show_title { DrawTitle } if
  show_xaxis_label { DrawXaxisLable } if
  show_fineprint { DrawFineprint } if
  DrawLogoLabel
  
  
  MoveToFirstLine
} bind def


/DrawLogoLabel {
  gsave 
    SetTitleFont
    
    logo_margin
    logo_height title_fontsize sub logo_margin sub
    moveto
    
    debug { title_fontsize logo_label stringwidth pop DrawBox } if
    0 title_fontsize 4 div rmoveto % Move up to baseline (approximatly)
    logo_label show
    
  grestore
} bind def

/DrawTitle {
  gsave 
    SetTitleFont
    
    logo_width 2 div logo_title stringwidth pop 2 div sub 
    logo_height title_fontsize sub logo_margin sub
    moveto
    
    debug { title_fontsize logo_title stringwidth pop DrawBox } if
    
    0 title_fontsize 4 div rmoveto % Move up to baseline (approximatly)
    logo_title show
    
  grestore
} bind def

/DrawXaxisLable {
  % Print X-axis label, bottom center
  gsave
    SetStringFont

    logo_width 2 div xaxis_label stringwidth pop 2 div sub
    xaxis_label_height logo_margin add fontsize sub
    moveto
    %fontsize 3 div
    
    debug { fontsize xaxis_label stringwidth pop DrawBox } if

    xaxis_label show

  grestore
} bind def


/DrawFineprint {
    gsave
    
    SetSmallFont

    logo_width fineprint stringwidth pop sub 
        logo_margin sub line_margin_right sub
    logo_margin 
    moveto
    
    debug { small_fontsize fineprint stringwidth pop DrawBox } if
        
    fineprint show
    grestore
} bind def

/MoveToFirstLine {
    logo_margin 
    logo_height logo_margin sub title_height sub line_height sub
    moveto
} bind def

/EndLogo { 
  grestore 
  %showpage 
  %restore 
} bind def


/StartLine{ 
    gsave 
  
    % Draw outer box
    debug { line_height line_width DrawBox } if  

    % Move to lower left corner of content area
    line_margin_left line_margin_bottom rmoveto

    % Draw inner content box
    debug { 
        line_height line_margin_bottom sub line_margin_top sub
        line_width line_margin_left sub line_margin_right sub
        DrawBox
    } if  
  
    show_yaxis { DrawYaxis } if
    show_xaxis { DrawLeftEnd } if
    
} bind def

/EndLine{ 
    show_xaxis { DrawRightEnd } if
    grestore 
    0 line_height neg rmoveto 
} bind def


/DrawYaxis {
  gsave    
    stack_margin neg 0 translate
    DrawYaxisBar
    DrawYaxisLabel
  grestore
} bind def


/DrawYaxisBar { 
  gsave  
    stack_margin neg 0 rmoveto
    
    SetNumberFont
    stroke_width setlinewidth
    
    /str 10 string def % string to hold number  
    /smallgap stack_margin  def

    % Draw first tic and bar
    gsave    
      tic_length neg 0 rmoveto 
      tic_length 0 rlineto 
      0 stack_height rlineto
      stroke
    grestore

    % Draw the tics
    % initial increment limit proc for
    0 yaxis_tic_interval yaxis_scale abs 
    {/loopnumber exch def

      % convert the number coming from the loop to a string
      % and find its width
      loopnumber 10 str cvrs
      /stringnumber exch def % string representing the number

      stringnumber stringwidth pop
      /numberwidth exch def % width of number to show

      /halfnumberheight
         stringnumber CharBoxHeight 2 div
      def

      gsave
        numberwidth % move back width of number
        neg loopnumber stack_height yaxis_scale div mul % shift on y axis
        halfnumberheight sub % down half the digit
        rmoveto % move back the width of the string

        tic_length neg smallgap sub % Move back a bit more  
        0 rmoveto % move back the width of the tic  

        stringnumber show
        smallgap 0 rmoveto % Make a small gap  

        % now show the tic mark
        0 halfnumberheight rmoveto % shift up again
        tic_length 0 rlineto
        stroke
     grestore
    } for
    
    % Draw the minor tics
    % initial increment limit proc for
    0 yaxis_minor_tic_interval yaxis_scale abs 
    {/loopnumber2 exch def
      gsave
        0
        loopnumber2 stack_height yaxis_scale div mul 
        rmoveto 

        tic_length 2 div neg 0 rlineto
        stroke
     grestore
    } for    
    
  grestore
} bind def

/DrawYaxisLabel {
  gsave
    SetStringFont

    % How far we move left depends on the size of
    % the tic labels.
    /str 10 string def % string to hold number  
    yaxis_scale yaxis_tic_interval div cvi yaxis_tic_interval mul 
    str cvs stringwidth pop
    tic_length 1.25 mul  add neg  

    stack_height
    yaxis_label stringwidth pop
    sub 2 div

    rmoveto
    90 rotate
    
    yaxis_label show
  grestore
} bind def


%Take a single character and return the bounding box
/CharBox { % <char> CharBox <lx> <ly> <ux> <uy>
  gsave
    newpath
    0 0 moveto
    % take the character off the stack and use it here:
    true charpath 
    flattenpath 
    pathbbox % compute bounding box of 1 pt. char => lx ly ux uy
    % the path is here, but toss it away ...
  grestore
} bind def


% The height of a characters bounding box
/CharBoxHeight { % <char> CharBoxHeight <num>
  CharBox
  exch pop sub neg exch pop
} bind def


% The width of a characters bounding box
/CharBoxWidth { % <char> CharBoxHeight <num>
  CharBox
  pop exch pop sub neg 
} bind def


/DrawLeftEnd {
  gsave
    SetStringFont
    leftEndDeltaX leftEndDeltaY rmoveto
    
    show_ends {
        debug { leftEndDeltaY neg leftEndDeltaX neg DrawBox } if
        end_type (d) eq {(5) show DrawPrime} if
        end_type (p) eq {(N) show} if
    } if
  grestore
} bind def

/DrawRightEnd { 
  gsave
    SetStringFont
    rightEndDeltaX rightEndDeltaY rmoveto
    
    show_ends {
        debug { rightEndDeltaY neg leftEndDeltaX neg  DrawBox } if
        end_type (d) eq {(3) show DrawPrime} if
        end_type (p) eq {(C) show} if
    } if
  grestore
} bind def

/DrawPrime {
  gsave
    SetPrimeFont
    (\242) show 
  grestore
} bind def


/StartStack {  % <stackNumber> startstack
  show_xaxis {DrawNumber}{pop} ifelse
  gsave
  debug { stack_height stack_width DrawBox } if
    
} bind def

/EndStack {
  grestore
  stack_width 0 rmoveto
} bind def


/DrawNumber { % number MakeNumber
    /n exch def
    
    
  gsave
    %0 stack_margin neg rmoveto
    stroke_width setlinewidth
    stack_width  0 rlineto
    stack_width 2 div neg 0 rmoveto
    
    n () eq 
    {  0 tic_length 4 div neg rlineto  } 
    { 0 tic_length 2 div neg rlineto } 
    ifelse

    stroke
  grestore   



  gsave
    n
    SetNumberFont
    stack_width 2 div tic_length 2 div neg rmoveto 

    rotate_numbers {
        90 rotate     
        dup stringwidth pop neg % find the length of the number
        stack_margin sub        % Move down a bit
        (0) CharBoxHeight 2 div neg % left half height of numbers
        rmoveto 
        show
    } {
        dup stringwidth pop neg 2 div number_fontsize neg  rmoveto
        show
    } ifelse
    
    

  grestore
} bind def



% Draw a character whose height is proportional to symbol bits
/ShowSymbol{ % interval character ShowSymbol
    /char exch def
    /interval exch def
    /fraction_width exch def
    
    /char_height 
       interval yaxis_scale div stack_height mul
       stack_margin sub
       dup 
       % if char_height is negative or very small replace with zero 
       % BUG FIX: This used to be '0.0 gt' but it seems that DrawHeight
       % has a finite, non-zero minimum, which results in a rangecheck error
       0.01 gt {}{pop 0.0} ifelse 
    def 

    char_height 0.0 gt {
        show_boxes {
            gsave
                /ww char_height stack_margin add def
                /hh stack_width def
                stroke_width setlinewidth
                hh 0 rlineto
                0 ww rlineto
                hh neg 0 rlineto
                0 ww neg rlineto
                stroke
            grestore     
        } if

        gsave
            stack_margin stack_margin rmoveto
            debug { char_height char_width DrawBox } if
            1 fraction_width sub char_width mul 2 div  0 rmoveto
            fraction_width char_width mul char_height char DrawChar
        grestore
        
    } if
    0 interval yaxis_scale div stack_height mul rmoveto
} bind def


/DrawChar { % <width> <height> <char> ShowChar
    /tc exch def    % The character
    /ysize exch def % the y size of the character
    /xsize exch def % the x size of the character
    /xmulfactor 1 def 
    /ymulfactor 1 def
    
    gsave
        SetLogoFont    
        tc SetColor

        % IReplacementHack
        % Deal with the lack of bars on the letter 'I' in Arial and Helvetica
        % by replacing with 'I' from Courier.
        tc (I) eq {
            /Courier findfont char_width  scalefont setfont    
        } if


        shrink {
            xsize 1 shrink_fraction sub 2 div mul
            ysize 1 shrink_fraction sub 2 div mul rmoveto 
            shrink_fraction shrink_fraction scale
        } if
        
        % Calculate the font scaling factors
        % Loop twice to catch small correction due to first scaling
        2 {
            gsave
            xmulfactor ymulfactor scale
      
            ysize % desired size of character in points
            tc CharBoxHeight 
            dup 0.0 ne {
                div % factor by which to scale up the character
                /ymulfactor exch def
            } {pop pop} ifelse

            xsize % desired size of character in points
            tc CharBoxWidth  
            dup 0.0 ne {
                div % factor by which to scale up the character
                /xmulfactor exch def
            } {pop pop} ifelse
            grestore
        } repeat


  
        % Draw the character
        xmulfactor ymulfactor scale
        % Move lower left corner of character to start point
        tc CharBox pop pop % llx lly : Lower left corner
        exch neg exch neg
        rmoveto
        
        tc show    

    grestore
} bind def

/SetColor{ % <char> SetColor
  dup color_dict exch known {
    color_dict exch get aload pop setrgbcolor
  } {
    pop
    default_color aload pop setrgbcolor
  } ifelse 
} bind def


/DrawErrorbar{ % interval_down interval_up DrawErrorbar
    
    gsave
    /points_per_unit stack_height yaxis_scale div def 
    /height_up   exch points_per_unit mul def 
    /height_down exch points_per_unit mul def
    
    show_errorbars {
    
    stroke_width setlinewidth
    errorbar_gray setgray     
    stack_width 2 div 0 rmoveto
    
    /errorbar_width char_width errorbar_width_fraction mul def
    /errorbar_width2 errorbar_width 2 div def
    
    gsave 
        0 height_down neg rmoveto
        errorbar_width2 neg 0 rlineto
        errorbar_width 0 rlineto
        errorbar_width2 neg 0 rlineto
        0 height_down errorbar_fraction mul rlineto 
        stroke
    grestore

    gsave 
        0 height_up  rmoveto
        errorbar_width2 neg 0 rlineto
        errorbar_width 0 rlineto
        errorbar_width2 neg 0 rlineto
        0 height_up neg errorbar_fraction mul rlineto 
        stroke
    grestore
    } if
           
    grestore
    
} bind def

/DrawErrorbarFirst{ % interval_down interval_up center DrawErrorbarFirst
    gsave
    /points_per_unit stack_height yaxis_scale div def 
    /center   exch points_per_unit mul def 

    0 center rmoveto
    DrawErrorbar
    grestore
} bind def

%%EndProlog

%%Page: 1 1

% Example Data
%StartLogo
%    StartLine
%        (1) StartStack
%            1.2 (C) ShowSymbol
%            2.2 (I) ShowSymbol
%            0.5 0.5 DrawErrorbar
%        EndStack
%        (2) StartStack
%            0.5 (I) ShowSymbol
%            0.9 (L) ShowSymbol
%            1.0 (G) ShowSymbol
%            
%            0.5 0.5 DrawErrorbar        
%        EndStack
%        (234) StartStack
%        EndStack
%        (235) StartStack
%        EndStack
%    EndLine
%EndLogo

StartLogo

StartLine
() StartStack
 1.000000 0.007655 (C) ShowSymbol
 1.000000 0.030619 (G) ShowSymbol
 1.000000 0.160751 (T) ShowSymbol
 1.000000 0.176061 (A) ShowSymbol
 0.163796 0.163796 DrawErrorbar
EndStack

() StartStack
 1.000000 0.011406 (C) ShowSymbol
 1.000000 0.034217 (G) ShowSymbol
 1.000000 0.102652 (T) ShowSymbol
 1.000000 0.131167 (A) ShowSymbol
 0.156619 0.156619 DrawErrorbar
EndStack

() StartStack
 1.000000 0.012415 (C) ShowSymbol
 1.000000 0.027934 (G) ShowSymbol
 1.000000 0.055869 (T) ShowSymbol
 1.000000 0.055869 (A) ShowSymbol
 0.096923 0.145203 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (A) ShowSymbol
 1.000000 0.029490 (G) ShowSymbol
 1.000000 0.117961 (C) ShowSymbol
 1.000000 0.575062 (T) ShowSymbol
 0.224264 0.224264 DrawErrorbar
EndStack

(5) StartStack
 1.000000 0.014625 (C) ShowSymbol
 1.000000 0.029249 (A) ShowSymbol
 1.000000 0.087747 (T) ShowSymbol
 1.000000 0.584982 (G) ShowSymbol
 0.247103 0.247103 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (G) ShowSymbol
 1.000000 0.015940 (A) ShowSymbol
 1.000000 0.127520 (C) ShowSymbol
 1.000000 0.637598 (T) ShowSymbol
 0.220715 0.220715 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (C) ShowSymbol
 1.000000 0.062924 (T) ShowSymbol
 1.000000 0.062924 (A) ShowSymbol
 1.000000 0.644973 (G) ShowSymbol
 0.240651 0.240651 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (T) ShowSymbol
 1.000000 0.052861 (G) ShowSymbol
 1.000000 0.052861 (C) ShowSymbol
 1.000000 0.757672 (A) ShowSymbol
 0.244911 0.244911 DrawErrorbar
EndStack

() StartStack
 1.000000 0.019826 (A) ShowSymbol
 1.000000 0.029739 (G) ShowSymbol
 1.000000 0.033044 (C) ShowSymbol
 1.000000 0.079304 (T) ShowSymbol
 0.109884 0.171140 DrawErrorbar
EndStack

(10) StartStack
 1.000000 0.010637 (A) ShowSymbol
 1.000000 0.011819 (G) ShowSymbol
 1.000000 0.015364 (T) ShowSymbol
 1.000000 0.020092 (C) ShowSymbol
 0.050133 0.099366 DrawErrorbar
EndStack

() StartStack
 1.000000 0.013628 (G) ShowSymbol
 1.000000 0.024531 (A) ShowSymbol
 1.000000 0.040884 (C) ShowSymbol
 1.000000 0.054513 (T) ShowSymbol
 0.091652 0.143816 DrawErrorbar
EndStack

() StartStack
 1.000000 0.011269 (C) ShowSymbol
 1.000000 0.016099 (T) ShowSymbol
 1.000000 0.024148 (A) ShowSymbol
 1.000000 0.027368 (G) ShowSymbol
 0.063336 0.113759 DrawErrorbar
EndStack

() StartStack
 1.000000 0.016591 (C) ShowSymbol
 1.000000 0.020739 (T) ShowSymbol
 1.000000 0.020739 (A) ShowSymbol
 1.000000 0.043551 (G) ShowSymbol
 0.079411 0.138638 DrawErrorbar
EndStack

() StartStack
 1.000000 0.010050 (G) ShowSymbol
 1.000000 0.015794 (C) ShowSymbol
 1.000000 0.021537 (T) ShowSymbol
 1.000000 0.022972 (A) ShowSymbol
 0.057620 0.105881 DrawErrorbar
EndStack

(15) StartStack
 1.000000 0.025125 (C) ShowSymbol
 1.000000 0.050251 (A) ShowSymbol
 1.000000 0.058626 (G) ShowSymbol
 1.000000 0.276380 (T) ShowSymbol
 0.219267 0.219267 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (G) ShowSymbol
 1.000000 0.043063 (T) ShowSymbol
 1.000000 0.100480 (A) ShowSymbol
 1.000000 0.559816 (C) ShowSymbol
 0.229096 0.229096 DrawErrorbar
EndStack

() StartStack
 1.000000 0.011202 (C) ShowSymbol
 1.000000 0.033605 (T) ShowSymbol
 1.000000 0.112016 (G) ShowSymbol
 1.000000 0.392057 (A) ShowSymbol
 0.220483 0.220483 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (G) ShowSymbol
 1.000000 0.067557 (T) ShowSymbol
 1.000000 0.096509 (A) ShowSymbol
 1.000000 0.308830 (C) ShowSymbol
 0.185045 0.185045 DrawErrorbar
EndStack

() StartStack
 1.000000 0.032608 (C) ShowSymbol
 1.000000 0.048911 (T) ShowSymbol
 1.000000 0.048911 (G) ShowSymbol
 1.000000 0.269013 (A) ShowSymbol
 0.220668 0.220668 DrawErrorbar
EndStack

(20) StartStack
 1.000000 0.015919 (G) ShowSymbol
 1.000000 0.020467 (C) ShowSymbol
 1.000000 0.027289 (A) ShowSymbol
 1.000000 0.047756 (T) ShowSymbol
 0.084037 0.141889 DrawErrorbar
EndStack

() StartStack
 1.000000 0.000000 (G) ShowSymbol
 1.000000 0.011991 (C) ShowSymbol
 1.000000 0.215832 (A) ShowSymbol
 1.000000 0.359720 (T) ShowSymbol
 0.161853 0.161853 DrawErrorbar
EndStack

() StartStack
 1.000000 0.017069 (G) ShowSymbol
 1.000000 0.029870 (C) ShowSymbol
 1.000000 0.059740 (A) ShowSymbol
 1.000000 0.102412 (T) ShowSymbol
 0.123311 0.177295 DrawErrorbar
EndStack

EndLine

EndLogo


%%EOF
