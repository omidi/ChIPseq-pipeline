<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<component>
    <name>SelectPeaks_byShapeShifting2</name>
    <!--<version>1.0</version>-->
    <doc>
    This component selects peaks by taking into account:
        -Z-score
        -length of peak at half height
        -fit to a Gaussian
    </doc>
    <author email="severin.berger@stud.unibas.ch">Severin</author>
    <launcher type="python">
        <argument name="file" value="SelectPeaks_byShapeShiftingNew.py" />
    </launcher>
    <requires>URL="http://www.python.org/not" type="manual">python</requires>
    <inputs>
        <input name="in_dir" type="BinaryFolder">
            <doc>Output directory of RegionCoverage. Contains top files with bp coverage per region.</doc>
        </input>
        <input name="Z_scores" type="BinaryFile">
            <doc>This is the output file of PeakMerger that contains merged windows sorted by Z-value with Z-value printed in the file.</doc>
        </input>
    </inputs>
    <outputs>
        <output name="peakscores" type="BinaryFile">
            <doc>File containig the scores of all peaks (Z-score and RMSD to Gaussian)</doc>
        </output>
        <output name="statistics" type="BinaryFile">
            <doc>File containig the lengths (at half height) and heights of all peaks.</doc>
        </output>
        <output name="out_dir" type="BinaryFolder">
            <doc>Contains coverage files of the peaks that passed the filtering.</doc>
        </output>
        <output name="bad_dir" type="BinaryFolder">
            <doc>Contains coverage files of the peaks that did not pass the filtering (length and RMSD).</doc>
        </output>
        <output name="log_file" type="BinaryFile">
            <doc>Log file.</doc>
        </output>
        <output name="intermediate" type="BinaryFolder">
            <doc>Directory for output mainly plots.</doc>
        </output>
        <output name="peakOverlay" type="PDF">
            <doc>PDF with overlayed peak plots of selected peaks, not selected peaks and peaks that have high Z-score but were not selected.</doc>
        </output>
    </outputs>
    <parameters>
        <parameter name="FGfiles_string" type="string" default="">
            <doc>Used to find the fragment length log_file. Fragment length is used to find reasonable cut-offs on peak lengths.</doc>
        </parameter>
        <parameter name="FragmentLength" type="int" default="-1">
            <doc>This is used for cut-off on length of peaks. All peaks longer than 2 times fragment length get discarded. If this value is negative, fragment length is read from FGfiles_string.</doc>
        </parameter>
        <parameter name="topPeaks" type="int" default="500">
            <doc>Number of peaks given as output after filtering.</doc>
        </parameter>
        <parameter name="giveout" type="string" default="">
            <doc>Based on what given out peaks should be selected. z=Zscores, q=RMSD, s=combined score.</doc>
        </parameter>
        <parameter name="Q_cutoff" type="float" default="0.06">
            <doc>All peaks in in_dir with RMSD/Q value lower than Q_cutoff get sorted out beforehand. giveout=z (should be used). If giveout=q, toppeaks peaks are given out sorted by q score. </doc>
        </parameter>
    </parameters>
</component>
